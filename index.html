<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Detección de Arsénico en Agua Potable – Chihuahua</title>

  <!-- Resources -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-minimap/dist/Control.MiniMap.min.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-compass/dist/leaflet-compass.min.css" />

  <style>
    #map { height: 500px; width: 100%; position: relative; }
    #titulo-mapa { position: absolute; top: 8px; left: 50%; transform: translateX(-50%); z-index: 1000; background: rgba(255, 255, 255, 0.85); padding: 6px 12px; border-radius: 6px; font-family: sans-serif; box-shadow: 0 0 5px rgba(0,0,0,0.3); }
    #titulo-mapa h2 { margin: 0; font-size: 18px; text-align: center; }
    #logos { position: absolute; bottom: 300px; left: 10px; z-index: 1000; background: rgba(255, 255, 255, 0.85); padding: 4px 6px; border-radius: 5px; display: flex; gap: 8px; align-items: center; box-shadow: 0 0 4px rgba(0,0,0,0.3); }
    #logos img { height: 45px; max-width: 60px; object-fit: contain; }
    #pie-pagina { position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); z-index: 1000; font-size: 12px; background: rgba(255,255,255,0.8); padding: 4px 10px; border-radius: 4px; font-family: sans-serif; box-shadow: 0 0 3px rgba(0,0,0,0.2); }
    @media (max-width: 768px) { #pie-pagina { display: none; } #titulo-mapa h2 { font-size: 14px; } #logos img { height: 32px; } .info-box, .legend { font-size: 12px; padding: 6px; } .leaflet-control-minimap { display: none; } }
    .legend { background: white; padding: 10px; line-height: 1.4em; border-radius: 5px; font-size: 13px; color: #333; box-shadow: 0 0 6px rgba(0,0,0,0.3); }
    .legend span { display:inline-block; width:12px; height:12px; margin-right:6px; border-radius:50%; }
    .color-rojo { background:red; }
    .color-azul { background:blue; }
    .color-verde { background:green; }
    .zona-label { font-size:14px; color:#000; background:rgba(255,255,255,0.7); padding:2px 6px; border-radius:4px; pointer-events:none; }
    .info-box { background: white; padding:8px; border-radius:5px; box-shadow:0 0 6px rgba(0,0,0,0.3); font-size:13px; }
    .leaflet-control-minimap { border:1px solid #ccc; }
  </style>
</head>
<body>
  <div id="map"></div>
  <div id="titulo-mapa"><h2>Detección de Arsénico en Agua Potable – Chihuahua</h2></div>
  <div id="logos">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQNnAS26nhdsMEyTqi1ccXa-kG_eiqIwBGcSg&s" alt="Logo FCQ/UACH">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTuQUMI6FVsjhpfo4kR4pnQy1eG0HTLlgyviA&s" alt="CIMAV">
  </div>
  <div id="pie-pagina">Proyecto académico 20va Edición del Verano de Investigación Científica · Créditos: CIMAV-SECIHTI · Datos: STADIAMAPS, INEGI, 2025</div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet-minimap/dist/Control.MiniMap.min.js"></script>
  <script src="https://unpkg.com/leaflet-compass/dist/leaflet-compass.min.js"></script>
  <script>
    var capa1 = L.tileLayer('https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png', { maxZoom: 18, attribution: '&copy; Stadia Maps, OpenStreetMap contributors' });
    var capa2 = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png');
    var capa3 = L.tileLayer('https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png');
    var capaEsriSat = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', { attribution: 'Tiles © Esri' });
    var capaEsriTopo = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}', { attribution: 'Tiles © Esri' });
    var capaCartoLight = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', { attribution: '&copy; CartoDB' });
    var capaCartoDark = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', { attribution: '&copy; CartoDB' });

    var map = L.map('map', { center: [28.67, -106.1], zoom: 11, layers: [capa1] });

    var miniMap = new L.Control.MiniMap(capa2, { toggleDisplay: true, minimized: false, position: 'bottomleft' }).addTo(map);
    L.control.scale().addTo(map);

    var infoControl = L.control({ position: 'topright' });
    infoControl.onAdd = function (map) { var div = L.DomUtil.create('div', 'info-box'); div.innerHTML = "<b>Información del punto:</b><br><div id='info-texto'>Selecciona un punto en el mapa.</div>"; return div; };
    infoControl.addTo(map);

    var puntos = [
      { nombre: "A-01", grupo: "A", lat: 28.7356, lng: -106.124055, extra: "En este punto se tomaron 3 muestras más: dos de control y una de verificación después del periodo de lluvias." },
      { nombre: "A-02", grupo: "A", lat: 28.73836, lng: -106.13267 },
      { nombre: "A-03", grupo: "A", lat: 28.74376, lng: -106.132388 },
      { nombre: "B-04", grupo: "B", lat: 28.66911, lng: -106.112844 },
      { nombre: "B-05", grupo: "B", lat: 28.65202, lng: -106.138525 },
      { nombre: "B-06", grupo: "B", lat: 28.66207, lng: -106.127324 },
      { nombre: "C-07", grupo: "C", lat: 28.64531, lng: -106.02162 },
      { nombre: "C-08", grupo: "C", lat: 28.62303, lng: -106.01914 },
      { nombre: "C-09", grupo: "C", lat: 28.62859, lng: -106.02545 }
    ];
    var colores = { A: "red", B: "blue", C: "green" };
    puntos.forEach(function(punto) {
      const popupTexto = `<b>${punto.nombre}</b><br>Lat: ${punto.lat.toFixed(5)}, Lng: ${punto.lng.toFixed(5)}<br>${punto.extra || ""}`;
      const marker = L.circleMarker([punto.lat, punto.lng], { radius: 10, color: colores[punto.grupo], fillColor: colores[punto.grupo], fillOpacity: 0.5 }).addTo(map).bindPopup(popupTexto);
      marker.on('click', function() { const texto = punto.extra || "Sin observaciones adicionales."; document.getElementById('info-texto').innerHTML = `<b>${punto.nombre}</b><br>${texto}<br>Lat: ${punto.lat}, Lng: ${punto.lng}`; });
    });

    var zonas = [
      { nombre: "Zona A", lat: 28.7399, lng: -106.1297, offsetLat: 0.015, offsetLng: 0, color: "red" },
      { nombre: "Zona B", lat: 28.658611, lng: -106.125556, offsetLat: 0.012, offsetLng: 0, color: "blue" },
      { nombre: "Zona C", lat: 28.6323, lng: -106.0221, offsetLat: -0.02, offsetLng: 0, color: "green" }
    ];
    zonas.forEach(function(zona) {
      L.circle([zona.lat, zona.lng], { radius: 2000, color: zona.color, fillOpacity: 0, weight: 2, dashArray: '6, 6', interactive: false }).addTo(map);
      L.marker([zona.lat + zona.offsetLat, zona.lng + zona.offsetLng], { icon: L.divIcon({ className: 'zona-label', html: `<b>${zona.nombre}</b>`, iconSize: [100, 20] }) }).addTo(map);
    });

    var legend = L.control({ position: 'bottomright' });
    legend.onAdd = function () { var div = L.DomUtil.create('div', 'legend'); div.innerHTML += "<strong>Leyenda</strong><br>"; div.innerHTML += "<span class='color-rojo'></span> Zona A (Norte)<br>"; div.innerHTML += "<span class='color-azul'></span> Zona B (Centro)<br>"; div.innerHTML += "<span class='color-verde'></span> Zona C (Sur)<br>"; return div; };
    legend.addTo(map);

    var capaPozos = L.tileLayer.wms('https://gaia.inegi.org.mx/NLB/tunnel/wms/wms61?', { layers: 'c111servicios', format: 'image/png', transparent: true, version: '1.1.1' });
    var capaCuencas = L.tileLayer.wms('https://gaia.inegi.org.mx/NLB/tunnel/wms/wms61?', { layers: 'c400', format: 'image/png', transparent: true, version: '1.1.1' });
    var capaConcentracionPozos = L.tileLayer.wms('https://gaia.inegi.org.mx/NLB/tunnel/wms/wms61?', { layers: 'c455', format: 'image/png', transparent: true, version: '1.1.1' });

    var baseMaps = { "Claro Stadia": capa1, "OSM": capa2, "Oscuro Stadia": capa3, "Esri Satélite": capaEsriSat, "Esri Topográfico": capaEsriTopo, "Carto Light": capaCartoLight, "Carto Dark": capaCartoDark };
    var overlayMaps = { "Áreas de concentración pozos INEGI <br>Aguas Subterráneas 1:250 000 (1996-2008)": capaCuencas };
    L.control.layers(baseMaps, overlayMaps).addTo(map);
  </script>
</body>
</html>
